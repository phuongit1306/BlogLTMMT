<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Bài 6 - Xây dựng Chat Server nhiều người dùng (Multi-Client Chat) | Blog Lập Trình - 2180607911 - Nguyễn Thanh Phương - 21DTHD3</title>
<meta name="keywords" content="Java, Socket, Multithreading, Chat, Networking">
<meta name="description" content="
Sau khi đã tạo thành công chat hai chiều giữa 1 client và 1 server ở bài trước, chúng ta sẽ tiếp tục phát triển thành chat nhiều người dùng cùng lúc.
Ứng dụng này giúp nhiều client có thể trò chuyện trong cùng một phòng chat giống như Messenger group hoặc Discord 🔥


🧩 1. Ý tưởng hệ thống
⚙️ Cấu trúc hoạt động

  
      
          Thành phần
          Mô tả
      
  
  
      
          Server
          Chờ nhiều client kết nối, mỗi client có một luồng riêng để giao tiếp
      
      
          Client
          Kết nối đến server, gửi và nhận tin nhắn
      
      
          Broadcast
          Server gửi tin nhắn từ 1 client đến tất cả client khác
      
  

📸 Sơ đồ hoạt động:
">
<meta name="author" content="Nguyễn Thanh Phương">
<link rel="canonical" href="https://phuongit1306.github.io/BlogLTMMT/blog/bai6-xay-dung-chat-server-nhieu-nguoi-dung/">
<link crossorigin="anonymous" href="/BlogLTMMT/assets/css/stylesheet.a482bf00fa5c046040ef7973ad5fdf5657890cacb596c93f1382f664ca542074.css" integrity="sha256-pIK/APpcBGBA73lzrV/fVleJDKy1lsk/E4L2ZMpUIHQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://phuongit1306.github.io/BlogLTMMT/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://phuongit1306.github.io/BlogLTMMT/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://phuongit1306.github.io/BlogLTMMT/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://phuongit1306.github.io/BlogLTMMT/apple-touch-icon.png">
<link rel="mask-icon" href="https://phuongit1306.github.io/BlogLTMMT/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://phuongit1306.github.io/BlogLTMMT/blog/bai6-xay-dung-chat-server-nhieu-nguoi-dung/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://phuongit1306.github.io/BlogLTMMT/blog/bai6-xay-dung-chat-server-nhieu-nguoi-dung/">
  <meta property="og:site_name" content="Blog Lập Trình - 2180607911 - Nguyễn Thanh Phương - 21DTHD3">
  <meta property="og:title" content="Bài 6 - Xây dựng Chat Server nhiều người dùng (Multi-Client Chat)">
  <meta property="og:description" content=" Sau khi đã tạo thành công chat hai chiều giữa 1 client và 1 server ở bài trước, chúng ta sẽ tiếp tục phát triển thành chat nhiều người dùng cùng lúc. Ứng dụng này giúp nhiều client có thể trò chuyện trong cùng một phòng chat giống như Messenger group hoặc Discord 🔥 🧩 1. Ý tưởng hệ thống ⚙️ Cấu trúc hoạt động Thành phần Mô tả Server Chờ nhiều client kết nối, mỗi client có một luồng riêng để giao tiếp Client Kết nối đến server, gửi và nhận tin nhắn Broadcast Server gửi tin nhắn từ 1 client đến tất cả client khác 📸 Sơ đồ hoạt động: ">
  <meta property="og:locale" content="vi">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2025-10-10T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-10-10T00:00:00+00:00">
    <meta property="article:tag" content="Java">
    <meta property="article:tag" content="Socket">
    <meta property="article:tag" content="Multithreading">
    <meta property="article:tag" content="Chat">
    <meta property="article:tag" content="Networking">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Bài 6 - Xây dựng Chat Server nhiều người dùng (Multi-Client Chat)">
<meta name="twitter:description" content="
Sau khi đã tạo thành công chat hai chiều giữa 1 client và 1 server ở bài trước, chúng ta sẽ tiếp tục phát triển thành chat nhiều người dùng cùng lúc.
Ứng dụng này giúp nhiều client có thể trò chuyện trong cùng một phòng chat giống như Messenger group hoặc Discord 🔥


🧩 1. Ý tưởng hệ thống
⚙️ Cấu trúc hoạt động

  
      
          Thành phần
          Mô tả
      
  
  
      
          Server
          Chờ nhiều client kết nối, mỗi client có một luồng riêng để giao tiếp
      
      
          Client
          Kết nối đến server, gửi và nhận tin nhắn
      
      
          Broadcast
          Server gửi tin nhắn từ 1 client đến tất cả client khác
      
  

📸 Sơ đồ hoạt động:
">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Blog - Lập trình mạng máy tính",
      "item": "https://phuongit1306.github.io/BlogLTMMT/blog/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Bài 6 - Xây dựng Chat Server nhiều người dùng (Multi-Client Chat)",
      "item": "https://phuongit1306.github.io/BlogLTMMT/blog/bai6-xay-dung-chat-server-nhieu-nguoi-dung/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Bài 6 - Xây dựng Chat Server nhiều người dùng (Multi-Client Chat)",
  "name": "Bài 6 - Xây dựng Chat Server nhiều người dùng (Multi-Client Chat)",
  "description": " Sau khi đã tạo thành công chat hai chiều giữa 1 client và 1 server ở bài trước, chúng ta sẽ tiếp tục phát triển thành chat nhiều người dùng cùng lúc. Ứng dụng này giúp nhiều client có thể trò chuyện trong cùng một phòng chat giống như Messenger group hoặc Discord 🔥 🧩 1. Ý tưởng hệ thống ⚙️ Cấu trúc hoạt động Thành phần Mô tả Server Chờ nhiều client kết nối, mỗi client có một luồng riêng để giao tiếp Client Kết nối đến server, gửi và nhận tin nhắn Broadcast Server gửi tin nhắn từ 1 client đến tất cả client khác 📸 Sơ đồ hoạt động: ",
  "keywords": [
    "Java", "Socket", "Multithreading", "Chat", "Networking"
  ],
  "articleBody": " Sau khi đã tạo thành công chat hai chiều giữa 1 client và 1 server ở bài trước, chúng ta sẽ tiếp tục phát triển thành chat nhiều người dùng cùng lúc. Ứng dụng này giúp nhiều client có thể trò chuyện trong cùng một phòng chat giống như Messenger group hoặc Discord 🔥 🧩 1. Ý tưởng hệ thống ⚙️ Cấu trúc hoạt động Thành phần Mô tả Server Chờ nhiều client kết nối, mỗi client có một luồng riêng để giao tiếp Client Kết nối đến server, gửi và nhận tin nhắn Broadcast Server gửi tin nhắn từ 1 client đến tất cả client khác 📸 Sơ đồ hoạt động: 🧱 2. Kiến trúc chương trình Chúng ta chia ứng dụng thành 3 file:\nChatServer.java – Quản lý kết nối và gửi tin nhắn đến tất cả người dùng ClientHandler.java – Xử lý từng client trên một luồng riêng ChatClient.java – Giao diện phía người dùng 🖥️ 3. Mã nguồn chi tiết 🧠 ChatServer.java import java.io.*; import java.net.*; import java.util.*; public class ChatServer { private static final int PORT = 5000; private static Set\u003cClientHandler\u003e clientHandlers = new HashSet\u003c\u003e(); public static void main(String[] args) { System.out.println(\"💬 Server đang chạy trên cổng \" + PORT); try (ServerSocket serverSocket = new ServerSocket(PORT)) { while (true) { Socket clientSocket = serverSocket.accept(); System.out.println(\"✅ Client mới kết nối: \" + clientSocket); ClientHandler clientHandler = new ClientHandler(clientSocket, clientHandlers); clientHandlers.add(clientHandler); new Thread(clientHandler).start(); } } catch (IOException e) { e.printStackTrace(); } } } ⚙️ ClientHandler.java\nimport java.io.*; import java.net.*; import java.util.*; public class ClientHandler implements Runnable { private Socket socket; private Set\u003cClientHandler\u003e clientHandlers; private PrintWriter out; private String clientName; public ClientHandler(Socket socket, Set\u003cClientHandler\u003e clientHandlers) { this.socket = socket; this.clientHandlers = clientHandlers; } @Override public void run() { try { BufferedReader in = new BufferedReader(new InputStreamReader(socket.getInputStream())); out = new PrintWriter(socket.getOutputStream(), true); out.println(\"Nhập tên của bạn:\"); clientName = in.readLine(); broadcast(\"🔔 \" + clientName + \" đã tham gia phòng chat!\"); String message; while ((message = in.readLine()) != null) { if (message.equalsIgnoreCase(\"exit\")) { broadcast(\"🚪 \" + clientName + \" đã rời khỏi phòng.\"); break; } broadcast(\"💬 \" + clientName + \": \" + message); } } catch (IOException e) { System.out.println(\"❌ Lỗi kết nối với \" + clientName); } finally { try { socket.close(); clientHandlers.remove(this); } catch (IOException e) { e.printStackTrace(); } } } private void broadcast(String message) { System.out.println(message); for (ClientHandler client : clientHandlers) { if (client != this) { client.out.println(message); } } } } 💻 ChatClient.java\nimport java.io.*; import java.net.*; public class ChatClient { public static void main(String[] args) { String host = \"localhost\"; int port = 5000; try (Socket socket = new Socket(host, port)) { System.out.println(\"🔗 Đã kết nối đến server!\"); BufferedReader input = new BufferedReader(new InputStreamReader(System.in)); BufferedReader reader = new BufferedReader(new InputStreamReader(socket.getInputStream())); PrintWriter writer = new PrintWriter(socket.getOutputStream(), true); // Luồng nhận tin nhắn new Thread(() -\u003e { try { String response; while ((response = reader.readLine()) != null) { System.out.println(response); } } catch (IOException e) { System.out.println(\"❌ Mất kết nối đến server!\"); } }).start(); // Gửi tin nhắn String userInput; while ((userInput = input.readLine()) != null) { writer.println(userInput); if (userInput.equalsIgnoreCase(\"exit\")) { break; } } } catch (IOException e) { System.out.println(\"❌ Không thể kết nối đến server!\"); } } } 🚀 4. Cách chạy chương trình ⚙️ Bước 1 – Chạy Server\njavac ChatServer.java ClientHandler.java java ChatServer ⚙️ Bước 2 – Mở 2 cửa sổ Terminal khác và chạy Client\njavac ChatClient.java java ChatClient 💡 Kết quả:\n💬 Server đang chạy trên cổng 5000 ✅ Client mới kết nối: /127.0.0.1 ✅ Client mới kết nối: /127.0.0.1 🔔 Nam đã tham gia phòng chat! 🔔 Phương đã tham gia phòng chat! 💬 Nam: Xin chào cả nhóm! 💬 Phương: Hello Nam 😄 🧠 5. Giải thích hoạt động Thành phần Chức năng ChatServer Tạo socket server, quản lý danh sách client ClientHandler Xử lý giao tiếp từng client trên luồng riêng broadcast() Gửi tin nhắn đến tất cả client khác exit Client thoát khỏi phòng chat 🪄 6. Mở rộng thêm Tính năng Mô tả ✅ Danh sách người dùng Gửi danh sách người online đến các client 💬 Phòng chat riêng Tạo nhiều phòng khác nhau 🖼️ Giao diện Dùng JavaFX / Swing để hiển thị cửa sổ chat đẹp hơn 🔐 Bảo mật Mã hóa dữ liệu bằng AES hoặc SSL Socket 🏁 7. Tổng kết Bằng cách kết hợp:\nSocket để giao tiếp mạng\nMultithreading để xử lý nhiều client\nBroadcast message để chia sẻ thông tin\n👉 Bạn đã tạo thành công Chat Server nhiều người dùng — nền tảng cho các ứng dụng chat thực tế.\n✍️ Tác giả: Nguyễn Thanh Phương\n📅 Cập nhật: October 19, 2025\n",
  "wordCount" : "774",
  "inLanguage": "en",
  "datePublished": "2025-10-10T00:00:00Z",
  "dateModified": "2025-10-10T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Nguyễn Thanh Phương"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://phuongit1306.github.io/BlogLTMMT/blog/bai6-xay-dung-chat-server-nhieu-nguoi-dung/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Blog Lập Trình - 2180607911 - Nguyễn Thanh Phương - 21DTHD3",
    "logo": {
      "@type": "ImageObject",
      "url": "https://phuongit1306.github.io/BlogLTMMT/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://phuongit1306.github.io/BlogLTMMT/" accesskey="h" title="Blog Lập Trình - 2180607911 - Nguyễn Thanh Phương - 21DTHD3 (Alt + H)">Blog Lập Trình - 2180607911 - Nguyễn Thanh Phương - 21DTHD3</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://phuongit1306.github.io/BlogLTMMT/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://phuongit1306.github.io/BlogLTMMT/blog" title="📝">
                    <span>📝</span>
                </a>
            </li>
            <li>
                <a href="https://phuongit1306.github.io/BlogLTMMT/about" title="📩">
                    <span>📩</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://phuongit1306.github.io/BlogLTMMT/">Home</a>&nbsp;»&nbsp;<a href="https://phuongit1306.github.io/BlogLTMMT/blog/">Blog - Lập trình mạng máy tính</a></div>
    <h1 class="post-title entry-hint-parent">
      Bài 6 - Xây dựng Chat Server nhiều người dùng (Multi-Client Chat)
    </h1>
    <div class="post-meta"><span title='2025-10-10 00:00:00 +0000 UTC'>October 10, 2025</span>&nbsp;·&nbsp;<span>4 min</span>&nbsp;·&nbsp;<span>Nguyễn Thanh Phương</span>

</div>
  </header> 
  <div class="post-content"><ul>
<li>Sau khi đã tạo thành công <strong>chat hai chiều giữa 1 client và 1 server</strong> ở bài trước, chúng ta sẽ tiếp tục phát triển thành <strong>chat nhiều người dùng cùng lúc</strong>.</li>
<li>Ứng dụng này giúp <strong>nhiều client có thể trò chuyện trong cùng một phòng chat</strong> giống như Messenger group hoặc Discord 🔥</li>
</ul>
<hr>
<h2 id="-1-ý-tưởng-hệ-thống">🧩 1. Ý tưởng hệ thống<a hidden class="anchor" aria-hidden="true" href="#-1-ý-tưởng-hệ-thống">#</a></h2>
<h3 id="-cấu-trúc-hoạt-động">⚙️ Cấu trúc hoạt động<a hidden class="anchor" aria-hidden="true" href="#-cấu-trúc-hoạt-động">#</a></h3>
<table>
  <thead>
      <tr>
          <th>Thành phần</th>
          <th>Mô tả</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Server</strong></td>
          <td>Chờ nhiều client kết nối, mỗi client có một luồng riêng để giao tiếp</td>
      </tr>
      <tr>
          <td><strong>Client</strong></td>
          <td>Kết nối đến server, gửi và nhận tin nhắn</td>
      </tr>
      <tr>
          <td><strong>Broadcast</strong></td>
          <td>Server gửi tin nhắn từ 1 client đến tất cả client khác</td>
      </tr>
  </tbody>
</table>
<p>📸 <em>Sơ đồ hoạt động:</em>
<img alt="Java Multi Chat Diagram" loading="lazy" src="../images/java-multi-chat-diagram.png"></p>
<hr>
<h2 id="-2-kiến-trúc-chương-trình">🧱 2. Kiến trúc chương trình<a hidden class="anchor" aria-hidden="true" href="#-2-kiến-trúc-chương-trình">#</a></h2>
<p>Chúng ta chia ứng dụng thành 3 file:</p>
<ol>
<li><strong>ChatServer.java</strong> – Quản lý kết nối và gửi tin nhắn đến tất cả người dùng</li>
<li><strong>ClientHandler.java</strong> – Xử lý từng client trên một luồng riêng</li>
<li><strong>ChatClient.java</strong> – Giao diện phía người dùng</li>
</ol>
<hr>
<h2 id="-3-mã-nguồn-chi-tiết">🖥️ 3. Mã nguồn chi tiết<a hidden class="anchor" aria-hidden="true" href="#-3-mã-nguồn-chi-tiết">#</a></h2>
<h3 id="-chatserverjava">🧠 ChatServer.java<a hidden class="anchor" aria-hidden="true" href="#-chatserverjava">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> java.io.*;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.net.*;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.*;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ChatServer</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> PORT <span style="color:#f92672">=</span> 5000;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> Set<span style="color:#f92672">&lt;</span>ClientHandler<span style="color:#f92672">&gt;</span> clientHandlers <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> HashSet<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) {
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;💬 Server đang chạy trên cổng &#34;</span> <span style="color:#f92672">+</span> PORT);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> (ServerSocket serverSocket <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ServerSocket(PORT)) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">true</span>) {
</span></span><span style="display:flex;"><span>                Socket clientSocket <span style="color:#f92672">=</span> serverSocket.<span style="color:#a6e22e">accept</span>();
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;✅ Client mới kết nối: &#34;</span> <span style="color:#f92672">+</span> clientSocket);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                ClientHandler clientHandler <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ClientHandler(clientSocket, clientHandlers);
</span></span><span style="display:flex;"><span>                clientHandlers.<span style="color:#a6e22e">add</span>(clientHandler);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">new</span> Thread(clientHandler).<span style="color:#a6e22e">start</span>();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">catch</span> (IOException e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#a6e22e">printStackTrace</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>⚙️ ClientHandler.java</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> java.io.*;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.net.*;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.*;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ClientHandler</span> <span style="color:#66d9ef">implements</span> Runnable {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Socket socket;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Set<span style="color:#f92672">&lt;</span>ClientHandler<span style="color:#f92672">&gt;</span> clientHandlers;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> PrintWriter out;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> String clientName;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">ClientHandler</span>(Socket socket, Set<span style="color:#f92672">&lt;</span>ClientHandler<span style="color:#f92672">&gt;</span> clientHandlers) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">socket</span> <span style="color:#f92672">=</span> socket;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">clientHandlers</span> <span style="color:#f92672">=</span> clientHandlers;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">run</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>            BufferedReader in <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedReader(<span style="color:#66d9ef">new</span> InputStreamReader(socket.<span style="color:#a6e22e">getInputStream</span>()));
</span></span><span style="display:flex;"><span>            out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PrintWriter(socket.<span style="color:#a6e22e">getOutputStream</span>(), <span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            out.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Nhập tên của bạn:&#34;</span>);
</span></span><span style="display:flex;"><span>            clientName <span style="color:#f92672">=</span> in.<span style="color:#a6e22e">readLine</span>();
</span></span><span style="display:flex;"><span>            broadcast(<span style="color:#e6db74">&#34;🔔 &#34;</span> <span style="color:#f92672">+</span> clientName <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; đã tham gia phòng chat!&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            String message;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">while</span> ((message <span style="color:#f92672">=</span> in.<span style="color:#a6e22e">readLine</span>()) <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (message.<span style="color:#a6e22e">equalsIgnoreCase</span>(<span style="color:#e6db74">&#34;exit&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    broadcast(<span style="color:#e6db74">&#34;🚪 &#34;</span> <span style="color:#f92672">+</span> clientName <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; đã rời khỏi phòng.&#34;</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                broadcast(<span style="color:#e6db74">&#34;💬 &#34;</span> <span style="color:#f92672">+</span> clientName <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;: &#34;</span> <span style="color:#f92672">+</span> message);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">catch</span> (IOException e) {
</span></span><span style="display:flex;"><span>            System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;❌ Lỗi kết nối với &#34;</span> <span style="color:#f92672">+</span> clientName);
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">finally</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>                socket.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>                clientHandlers.<span style="color:#a6e22e">remove</span>(<span style="color:#66d9ef">this</span>);
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">catch</span> (IOException e) {
</span></span><span style="display:flex;"><span>                e.<span style="color:#a6e22e">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">broadcast</span>(String message) {
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(message);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (ClientHandler client : clientHandlers) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (client <span style="color:#f92672">!=</span> <span style="color:#66d9ef">this</span>) {
</span></span><span style="display:flex;"><span>                client.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(message);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>💻 ChatClient.java</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> java.io.*;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.net.*;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ChatClient</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) {
</span></span><span style="display:flex;"><span>        String host <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;localhost&#34;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> port <span style="color:#f92672">=</span> 5000;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> (Socket socket <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Socket(host, port)) {
</span></span><span style="display:flex;"><span>            System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;🔗 Đã kết nối đến server!&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            BufferedReader input <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedReader(<span style="color:#66d9ef">new</span> InputStreamReader(System.<span style="color:#a6e22e">in</span>));
</span></span><span style="display:flex;"><span>            BufferedReader reader <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedReader(<span style="color:#66d9ef">new</span> InputStreamReader(socket.<span style="color:#a6e22e">getInputStream</span>()));
</span></span><span style="display:flex;"><span>            PrintWriter writer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PrintWriter(socket.<span style="color:#a6e22e">getOutputStream</span>(), <span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Luồng nhận tin nhắn</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">new</span> Thread(() <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>                    String response;
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">while</span> ((response <span style="color:#f92672">=</span> reader.<span style="color:#a6e22e">readLine</span>()) <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>                        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(response);
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">catch</span> (IOException e) {
</span></span><span style="display:flex;"><span>                    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;❌ Mất kết nối đến server!&#34;</span>);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }).<span style="color:#a6e22e">start</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Gửi tin nhắn</span>
</span></span><span style="display:flex;"><span>            String userInput;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">while</span> ((userInput <span style="color:#f92672">=</span> input.<span style="color:#a6e22e">readLine</span>()) <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>                writer.<span style="color:#a6e22e">println</span>(userInput);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (userInput.<span style="color:#a6e22e">equalsIgnoreCase</span>(<span style="color:#e6db74">&#34;exit&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">catch</span> (IOException e) {
</span></span><span style="display:flex;"><span>            System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;❌ Không thể kết nối đến server!&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h2 id="-4-cách-chạy-chương-trình">🚀 4. Cách chạy chương trình<a hidden class="anchor" aria-hidden="true" href="#-4-cách-chạy-chương-trình">#</a></h2>
<p>⚙️ Bước 1 – Chạy Server</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>javac ChatServer.<span style="color:#a6e22e">java</span> ClientHandler.<span style="color:#a6e22e">java</span>
</span></span><span style="display:flex;"><span>java ChatServer
</span></span></code></pre></div><p>⚙️ Bước 2 – Mở 2 cửa sổ Terminal khác và chạy Client</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>javac ChatClient.<span style="color:#a6e22e">java</span>
</span></span><span style="display:flex;"><span>java ChatClient
</span></span></code></pre></div><p>💡 Kết quả:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">💬</span> Server đang chạy trên cổng 5000
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">✅</span> Client mới kết nối: <span style="color:#f92672">/</span>127.<span style="color:#a6e22e">0</span>.<span style="color:#a6e22e">0</span>.<span style="color:#a6e22e">1</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">✅</span> Client mới kết nối: <span style="color:#f92672">/</span>127.<span style="color:#a6e22e">0</span>.<span style="color:#a6e22e">0</span>.<span style="color:#a6e22e">1</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">🔔</span> Nam đã tham gia phòng chat<span style="color:#f92672">!</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">🔔</span> Phương đã tham gia phòng chat<span style="color:#f92672">!</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">💬</span> Nam: Xin chào cả nhóm<span style="color:#f92672">!</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">💬</span> Phương: Hello Nam <span style="color:#960050;background-color:#1e0010">😄</span>
</span></span></code></pre></div><hr>
<h2 id="-5-giải-thích-hoạt-động">🧠 5. Giải thích hoạt động<a hidden class="anchor" aria-hidden="true" href="#-5-giải-thích-hoạt-động">#</a></h2>
<table>
  <thead>
      <tr>
          <th>Thành phần</th>
          <th>Chức năng</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>ChatServer</code></td>
          <td>Tạo socket server, quản lý danh sách client</td>
      </tr>
      <tr>
          <td><code>ClientHandler</code></td>
          <td>Xử lý giao tiếp từng client trên luồng riêng</td>
      </tr>
      <tr>
          <td><code>broadcast()</code></td>
          <td>Gửi tin nhắn đến tất cả client khác</td>
      </tr>
      <tr>
          <td><code>exit</code></td>
          <td>Client thoát khỏi phòng chat</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-6-mở-rộng-thêm">🪄 6. Mở rộng thêm<a hidden class="anchor" aria-hidden="true" href="#-6-mở-rộng-thêm">#</a></h2>
<table>
  <thead>
      <tr>
          <th>Tính năng</th>
          <th>Mô tả</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>✅ Danh sách người dùng</td>
          <td>Gửi danh sách người online đến các client</td>
      </tr>
      <tr>
          <td>💬 Phòng chat riêng</td>
          <td>Tạo nhiều phòng khác nhau</td>
      </tr>
      <tr>
          <td>🖼️ Giao diện</td>
          <td>Dùng <strong>JavaFX / Swing</strong> để hiển thị cửa sổ chat đẹp hơn</td>
      </tr>
      <tr>
          <td>🔐 Bảo mật</td>
          <td>Mã hóa dữ liệu bằng AES hoặc SSL Socket</td>
      </tr>
  </tbody>
</table>
<h2 id="-7-tổng-kết">🏁 7. Tổng kết<a hidden class="anchor" aria-hidden="true" href="#-7-tổng-kết">#</a></h2>
<p>Bằng cách kết hợp:</p>
<p>Socket để giao tiếp mạng</p>
<p>Multithreading để xử lý nhiều client</p>
<p>Broadcast message để chia sẻ thông tin</p>
<p>👉 Bạn đã tạo thành công Chat Server nhiều người dùng — nền tảng cho các ứng dụng chat thực tế.</p>
<hr>
<p>✍️ Tác giả: Nguyễn Thanh Phương</p>
<p>📅 Cập nhật: October 19, 2025</p>
<hr>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://phuongit1306.github.io/BlogLTMMT/tags/java/">Java</a></li>
      <li><a href="https://phuongit1306.github.io/BlogLTMMT/tags/socket/">Socket</a></li>
      <li><a href="https://phuongit1306.github.io/BlogLTMMT/tags/multithreading/">Multithreading</a></li>
      <li><a href="https://phuongit1306.github.io/BlogLTMMT/tags/chat/">Chat</a></li>
      <li><a href="https://phuongit1306.github.io/BlogLTMMT/tags/networking/">Networking</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://phuongit1306.github.io/BlogLTMMT/blog/bai7-lap-trinh-mang-voi-udp-trong-java/">
    <span class="title">« </span>
    <br>
    <span>Bài 7 - Lập trình mạng với UDP trong Java</span>
  </a>
  <a class="next" href="https://phuongit1306.github.io/BlogLTMMT/blog/bai5-giao-tiep-hai-chieu-trong-java/">
    <span class="title"> »</span>
    <br>
    <span>Bài 5 - Giao tiếp hai chiều trong Java bằng Socket (Chat Realtime)</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://phuongit1306.github.io/BlogLTMMT/">Blog Lập Trình - 2180607911 - Nguyễn Thanh Phương - 21DTHD3</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
